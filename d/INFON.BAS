SCREEN 12
WINDOW SCREEN (-20, -120)-(730, 540)
DIM feld(71, 46)
DIM x(15)
DIM y(15)
DIM xs(15)
DIM ys(15)
DIM xricht(15)
DIM yricht(15)
DIM modus(15)
DIM zahl(15)
FOR i = 1 TO 45
READ feld$
FOR a = 1 TO 70
feld(a, i) = VAL(MID$(feld$, a, 1))
NEXT

NEXT
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000001000000000000000000000000000000000000000000000001100
DATA 0000000000000000001000000000000000000000000000000000000000000000001100
DATA 0000000000000000001000000000000000000000000000000000000000000000000000
DATA 0000000000000000001000000000000000000000000000000000000000000000000000
DATA 0000000000000000001000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000001111111000000000000000000000000000000000
DATA 0000000000000000000000000000001111111000000000000000000000000000000000
DATA 0000000000000000000000000000001111111000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000001100000000000
DATA 0000000000011111111111000000000000000000000000000000000001100000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000''
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000001100000000000000000000
DATA 0000000000000000000000000000000000000000000000001111111100000000000000
DATA 0000000000000000000111000000000000000000000000000011111100000000000000
DATA 0000000000000000000111000000000000000000000000000011111100000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000110000000000000000000000
DATA 0000000000000000000000000000000000000000000000110000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000'''
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000001111111110000000001111000000000000000000000000000000000000000000
DATA 0000001111111110000000001111000000000000000000000000000000000000000000
DATA 0000001111111110000000001111000000000000000000000000000000000001100000
DATA 0000001111111110000000000000000000000000000011000000000000000001100000
DATA 0000001111111110000000000000000000000000000011000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000
DATA 0000000000000000000000000000000000000000000000000000000000000000000000


FOR x = 1 TO 70
FOR y = 1 TO 45
IF feld(x, y) = 0 THEN LINE (x * 10, y * 10)-(x * 10 + 10, y * 10 + 10), 2, BF
IF feld(x, y) = 1 THEN LINE (x * 10, y * 10)-(x * 10 + 10, y * 10 + 10), 0, BF
NEXT
NEXT


infonanz = 13

FOR i = 1 TO infonanz
x(i) = 35: y(i) = 7
IF INT(RND * 2) = 1 THEN e = 1 ELSE e = -1
xricht(i) = e
IF INT(RND * 2) = 1 THEN e = 1 ELSE e = -1
yricht(i) = e
modus(i) = 0

NEXT

DO

FOR durchl = 1 TO infonanz
IF feld(x(durchl), y(durchl)) = 0 THEN LINE (x(durchl) * 10, y(durchl) * 10)-(x(durchl) * 10 + 10, y(durchl) * 10 + 10), 2, BF
IF feld(x(durchl), y(durchl)) = 1 THEN LINE (x(durchl) * 10, y(durchl) * 10)-(x(durchl) * 10 + 10, y(durchl) * 10 + 10), 0, BF


w = INT(RND * 3)
IF w = 0 THEN e = 1
IF w = 1 THEN e = 0
IF w = 2 THEN e = -1

IF x(durchl) - 1 < 1 THEN xricht(durchl) = 1: yricht(durchl) = e
IF x(durchl) + 1 > 70 THEN xricht(durchl) = -1: yricht(durchl) = e
IF y(durchl) - 1 < 1 THEN yricht(durchl) = 1: xricht(durchl) = e
IF y(durchl) + 1 > 45 THEN yricht(durchl) = -1: xricht(durchl) = e


IF modus(durchl) = 0 THEN
x(durchl) = x(durchl) + xricht(durchl)
y(durchl) = y(durchl) + yricht(durchl)
END IF

IF modus(durchl) = 1 THEN
IF x(durchl) > 35 THEN x(durchl) = x(durchl) - 1
IF x(durchl) < 35 THEN x(durchl) = x(durchl) + 1
IF y(durchl) > 7 THEN y(durchl) = y(durchl) - 1
IF y(durchl) < 7 THEN y(durchl) = y(durchl) + 1
IF x(durchl) = 35 AND y(durchl) = 7 THEN modus(durchl) = 2
END IF

IF modus(durchl) = 2 THEN
IF x(durchl) > xs(durchl) THEN x(durchl) = x(durchl) - 1
IF x(durchl) < xs(durchl) THEN x(durchl) = x(durchl) + 1
IF y(durchl) > ys(durchl) THEN y(durchl) = y(durchl) - 1
IF y(durchl) < ys(durchl) THEN y(durchl) = y(durchl) + 1
IF x(durchl) = xs(durchl) AND y(durchl) = ys(durchl) THEN
  modus(durchl) = 3
 END IF
END IF

IF modus(durchl) = 3 THEN
zahl(durchl) = zahl(durchl) + 1
q = zahl(durchl)
IF q = 1 THEN x(durchl) = x(durchl) - 1
IF q = 2 THEN y(durchl) = y(durchl) - 1
IF q = 3 THEN x(durchl) = x(durchl) + 1
IF q = 4 THEN x(durchl) = x(durchl) + 1
IF q = 5 THEN y(durchl) = y(durchl) + 1
IF q = 6 THEN y(durchl) = y(durchl) + 1
IF q = 7 THEN x(durchl) = x(durchl) - 1
IF q = 8 THEN x(durchl) = x(durchl) - 1
IF q = 9 THEN x(durchl) = x(durchl) + 1: y(durchl) = y(durchl) - 1
IF q = 10 THEN
  IF INT(RND * 2) = 1 THEN e = 1 ELSE e = -1: xricht(durchl) = e
  IF INT(RND * 2) = 1 THEN e = 1 ELSE e = -1: yricht(durchl) = e
  zahl(durchl) = 0
  modus(durchl) = 0
 END IF
END IF

IF feld(x(durchl), y(durchl)) = 1 THEN
modus(durchl) = 1: feld(x(durchl), y(durchl)) = 0
xs(durchl) = x(durchl)
ys(durchl) = y(durchl)
END IF

IF durchl <> 2 THEN LINE (x(durchl) * 10, y(durchl) * 10)-(x(durchl) * 10 + 10, y(durchl) * 10 + 10), durchl, BF ELSE LINE (x(durchl) * 10, y(durchl) * 10)-(x(durchl) * 10 + 10, y(durchl) * 10 + 10), 14, BF


LINE (35 * 10, 7 * 10)-(35 * 10 + 10, 7 * 10 + 10), 15, BF

NEXT
LOOP



